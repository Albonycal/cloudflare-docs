{{- $filename := .Page.RelPermalink -}}
{{- $data := .Site.Data.learning_paths -}}
{{- $data2 := resources.Get "/learning_path.json" -}}

<script>console.log({{$data2}})</script>

{{- range where $data "path" $filename -}}

{{ with .resources.ByType "json" }}
	{{ range . }}
		<p>{{ .RelPermalink }}</p>
	{{ end }}
{{ end }}


<div class="header">
<h1>{{- .title -}}</h1>
<p><em>Learning path</em></p>
<p>{{- .description -}}</p>
</div>

<div class="background">
{{- range $index, $module := .modules -}}

<div class="learningPathModule">
<div class="moduleHeader">
<h2>{{.title}}</h2>
<p>{{.description}}</p>
</div>
{{- if eq $index 0 -}}
<details open>
{{ else }}
<details>
{{ end }}
<summary>Contains {{len .pages}} units</summary>
<div>
    <ul>
    {{- range .pages -}}
    {{ if isset . "external_link" }}
        <li><a href="{{.url_path}}" target="_blank">{{.link_title}}  {{- partialCached "external.icon" . -}}</a></li>
    {{ else if isset . "link_title"}}
        <li><a href="{{.url_path}}" target="_blank">{{.link_title}}</a></li>
    {{ else }}
    {{ with $.Site.GetPage (replaceRE "/$" "" .url_path) }}
    
    <li><a href="{{ .RelPermalink }}" target="_blank">{{ .Title }}</a></li>
    {{- end -}}
    {{- end -}}
    {{- end -}}
    </ul>

</div>
</details>
</div>

{{- end -}}

<div class="GoBack">
    <a href="/learning-paths/">View other learning paths</a>
</div>

</div>

{{- end -}}
